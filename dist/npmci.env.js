"use strict";
require("typings-global");
var plugins = require("./npmci.plugins");
var paths = require("./npmci.paths");
var smartstring_1 = require("smartstring");
exports.repo = new smartstring_1.GitRepo(process.env.CI_BUILD_REPO);
exports.buildStage = process.env.CI_BUILD_STAGE;
exports.dockerFilesBuilt = [];
exports.dockerFiles = [];
exports.configStore = function () {
    var config = {
        dockerRegistry: exports.dockerRegistry,
        dockerFilesBuilt: exports.dockerFilesBuilt,
        dockerFiles: exports.dockerFiles
    };
    plugins.smartfile.memory.toFsSync(JSON.stringify(config), {
        fileName: "config.json",
        filePath: paths.NpmciPackageRoot
    });
};
exports.configLoad = function () {
    var config;
    try {
        config = plugins.smartfile.local.toObjectSync(paths.NpmciPackageConfig, "json");
    }
    catch (err) {
        config = {};
        exports.configStore();
        plugins.beautylog.log("config initialized!");
    }
    config.dockerRegistry ? exports.dockerRegistry = config.dockerRegistry : void (0);
    config.dockerFilesBuilt ? exports.dockerFilesBuilt = config.dockerFilesBuilt : void (0);
};
exports.configLoad();

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5wbWNpLmVudi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsUUFBTyxnQkFBZ0IsQ0FBQyxDQUFBO0FBQ3hCLElBQVksT0FBTyxXQUFNLGlCQUFpQixDQUFDLENBQUE7QUFDM0MsSUFBWSxLQUFLLFdBQU0sZUFBZSxDQUFDLENBQUE7QUFDdkMsNEJBQXNCLGFBQWEsQ0FBQyxDQUFBO0FBR3pCLFlBQUksR0FBVyxJQUFJLHFCQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQztBQUV0RCxrQkFBVSxHQUFVLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFDO0FBSS9DLHdCQUFnQixHQUFnQixFQUFFLENBQUM7QUFDbkMsbUJBQVcsR0FBZ0IsRUFBRSxDQUFDO0FBRTlCLG1CQUFXLEdBQUc7SUFDckIsSUFBSSxNQUFNLEdBQUc7UUFDVCxjQUFjLEVBQUUsc0JBQWM7UUFDOUIsZ0JBQWdCLEVBQUUsd0JBQWdCO1FBQ2xDLFdBQVcsRUFBRSxtQkFBVztLQUMzQixDQUFBO0lBQ0QsT0FBTyxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUM3QixJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxFQUN0QjtRQUNJLFFBQVEsRUFBQyxhQUFhO1FBQ3RCLFFBQVEsRUFBQyxLQUFLLENBQUMsZ0JBQWdCO0tBQ2xDLENBQ0osQ0FBQztBQUNOLENBQUMsQ0FBQTtBQUVVLGtCQUFVLEdBQUc7SUFDcEIsSUFBSSxNQUFNLENBQUM7SUFDWCxJQUFJLENBQUM7UUFDRCxNQUFNLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsRUFBQyxNQUFNLENBQUMsQ0FBQztJQUNuRixDQUNBO0lBQUEsS0FBSyxDQUFBLENBQUMsR0FBRyxDQUFDLENBQUEsQ0FBQztRQUNQLE1BQU0sR0FBRyxFQUFFLENBQUM7UUFDWixtQkFBVyxFQUFFLENBQUM7UUFDZCxPQUFPLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO0lBQ2pELENBQUM7SUFFRCxNQUFNLENBQUMsY0FBYyxHQUFHLHNCQUFjLEdBQUcsTUFBTSxDQUFDLGNBQWMsR0FBRyxLQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDekUsTUFBTSxDQUFDLGdCQUFnQixHQUFHLHdCQUFnQixHQUFHLE1BQU0sQ0FBQyxnQkFBZ0IsR0FBRyxLQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDbkYsQ0FBQyxDQUFBO0FBQ0Qsa0JBQVUsRUFBRSxDQUFDIiwiZmlsZSI6Im5wbWNpLmVudi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcInR5cGluZ3MtZ2xvYmFsXCI7XHJcbmltcG9ydCAqIGFzIHBsdWdpbnMgZnJvbSBcIi4vbnBtY2kucGx1Z2luc1wiO1xyXG5pbXBvcnQgKiBhcyBwYXRocyBmcm9tIFwiLi9ucG1jaS5wYXRoc1wiO1xyXG5pbXBvcnQge0dpdFJlcG99IGZyb20gXCJzbWFydHN0cmluZ1wiO1xyXG5pbXBvcnQge0RvY2tlcmZpbGV9IGZyb20gXCIuL25wbWNpLmJ1aWxkLmRvY2tlclwiXHJcblxyXG5leHBvcnQgbGV0IHJlcG86R2l0UmVwbyA9IG5ldyBHaXRSZXBvKHByb2Nlc3MuZW52LkNJX0JVSUxEX1JFUE8pO1xyXG5cclxuZXhwb3J0IGxldCBidWlsZFN0YWdlOnN0cmluZyA9IHByb2Nlc3MuZW52LkNJX0JVSUxEX1NUQUdFO1xyXG5cclxuLy8gaGFuZGxpbmcgY29uZmlnIGJldHdlZW4gY29tbWFuZHNcclxuZXhwb3J0IGxldCBkb2NrZXJSZWdpc3RyeTsgLy8gd2lsbCBiZSBzZXQgYnkgbnBtY2kucHJlcGFyZVxyXG5leHBvcnQgbGV0IGRvY2tlckZpbGVzQnVpbHQ6RG9ja2VyZmlsZVtdID0gW107XHJcbmV4cG9ydCBsZXQgZG9ja2VyRmlsZXM6RG9ja2VyZmlsZVtdID0gW107XHJcblxyXG5leHBvcnQgbGV0IGNvbmZpZ1N0b3JlID0gKCkgPT4ge1xyXG4gICAgbGV0IGNvbmZpZyA9IHtcclxuICAgICAgICBkb2NrZXJSZWdpc3RyeTogZG9ja2VyUmVnaXN0cnksXHJcbiAgICAgICAgZG9ja2VyRmlsZXNCdWlsdDogZG9ja2VyRmlsZXNCdWlsdCxcclxuICAgICAgICBkb2NrZXJGaWxlczogZG9ja2VyRmlsZXNcclxuICAgIH1cclxuICAgIHBsdWdpbnMuc21hcnRmaWxlLm1lbW9yeS50b0ZzU3luYyhcclxuICAgICAgICBKU09OLnN0cmluZ2lmeShjb25maWcpLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZmlsZU5hbWU6XCJjb25maWcuanNvblwiLFxyXG4gICAgICAgICAgICBmaWxlUGF0aDpwYXRocy5OcG1jaVBhY2thZ2VSb290XHJcbiAgICAgICAgfVxyXG4gICAgKTtcclxufVxyXG5cclxuZXhwb3J0IGxldCBjb25maWdMb2FkID0gKCkgPT4ge1xyXG4gICAgbGV0IGNvbmZpZztcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uZmlnID0gcGx1Z2lucy5zbWFydGZpbGUubG9jYWwudG9PYmplY3RTeW5jKHBhdGhzLk5wbWNpUGFja2FnZUNvbmZpZyxcImpzb25cIik7XHJcbiAgICB9XHJcbiAgICBjYXRjaChlcnIpe1xyXG4gICAgICAgIGNvbmZpZyA9IHt9O1xyXG4gICAgICAgIGNvbmZpZ1N0b3JlKCk7XHJcbiAgICAgICAgcGx1Z2lucy5iZWF1dHlsb2cubG9nKFwiY29uZmlnIGluaXRpYWxpemVkIVwiKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uZmlnLmRvY2tlclJlZ2lzdHJ5ID8gZG9ja2VyUmVnaXN0cnkgPSBjb25maWcuZG9ja2VyUmVnaXN0cnkgOiB2b2lkKDApO1xyXG4gICAgY29uZmlnLmRvY2tlckZpbGVzQnVpbHQgPyBkb2NrZXJGaWxlc0J1aWx0ID0gY29uZmlnLmRvY2tlckZpbGVzQnVpbHQgOiB2b2lkKDApO1xyXG59XHJcbmNvbmZpZ0xvYWQoKTsiXX0=
